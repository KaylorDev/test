# Qwen3-TTS Читалка (Reader)

Приложение для озвучивания текста (TTS) и клонирования голоса на базе модели Qwen2.5-Math и репозитория Qwen2-Audio (адаптированного как Qwen3-TTS). Поддерживает чтение текстовых файлов, электронных книг и клонирование голоса по образцу.

## Возможности

*   **Озвучивание текста**: Поддержка ввода текста вручную или загрузки файлов (`.txt`, `.epub`, `.fb2`).
*   **Две модели**: Возможность выбора между `1.7B` (по умолчанию) и `0.6B` версиями модели.
*   **Клонирование голоса (One-Shot)**: Озвучивание голосом из предоставленного аудио-образца (требуется аудио + текст того, что в нем говорится).
*   **Профили голоса**: Создание, сохранение и загрузка профилей голоса для повторного использования.
*   **Индикатор устройства**: Отображение, на чем выполняется генерация (CPU или CUDA/GPU).
*   **Русский интерфейс**.

## Установка

### 1. Предварительные требования

*   **Python**: Рекомендуется версия 3.10 или 3.11.
*   **Git**: Для клонирования репозитория.
*   **Видеокарта NVIDIA (опционально)**: Для быстрой генерации рекомендуется видеокарта с поддержкой CUDA. На CPU генерация будет значительно медленнее.

### 2. Клонирование и настройка окружения

1.  Скачайте или клонируйте этот репозиторий.
2.  Откройте терминал (командную строку) в папке проекта.
3.  Создайте виртуальное окружение:

    ```bash
    python -m venv venv
    ```

4.  Активируйте виртуальное окружение:
    *   Windows: `venv\Scripts\activate`
    *   Linux/Mac: `source venv/bin/activate`

### 3. Установка зависимостей

Установите необходимые библиотеки:

```bash
pip install -r requirements.txt
```

**Важно для владельцев видеокарт NVIDIA:**
По умолчанию `pip` может установить PyTorch только для CPU. Для поддержки GPU выполните команду (подробнее на [pytorch.org](https://pytorch.org/)):

```bash
pip install torch torchaudio --index-url https://download.pytorch.org/whl/cu118
```
*(Версию `cu118` можно заменить на `cu121` или другую, подходящую под ваши драйверы).*

## Запуск

### Быстрый запуск (Windows)
Просто запустите файл `run_app.bat`.

### Ручной запуск
В активированном виртуальном окружении выполните:

```bash
python src/app.py
```
Приложение откроется в браузере по адресу `http://127.0.0.1:7860`.

## Использование

### Вкладка "Чтение / Озвучка"
1.  **Текст**: Введите текст вручную или загрузите файл (.txt, .epub, .fb2).
2.  **Модель**: Выберите модель (1.7B качественнее, но тяжелее).
3.  **Голос**:
    *   Выберите сохраненный голос из списка.
    *   ИЛИ загрузите "Образец голоса" (аудио) и введите "Текст образца" для одноразового клонирования.
    *   Если ничего не выбрано, модель может выдать ошибку (Base версии требуют референс).
4.  Нажмите **"Озвучить"**.

### Вкладка "Студия Клонирования Голоса"
1.  Загрузите аудио-файл с голосом, который хотите скопировать (желательно 5-15 секунд, чистого голоса).
2.  В поле "Текст образца" напишите **слово в слово**, что говорится в этом аудио.
3.  (Опционально) Введите имя для сохранения профиля.
4.  Нажмите **"Создать профиль голоса"**.
5.  Если имя было введено, голос сохранится и появится в списке на главной вкладке.

## Структура проекта

*   `src/app.py`: Код интерфейса (Gradio).
*   `src/tts_engine.py`: Логика работы с TTS моделью.
*   `temp_qwen_tts/`: Локальная копия библиотек модели Qwen.
*   `voices/`: Папка с сохраненными профилями голосов.
